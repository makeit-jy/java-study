# Chapter13 함수형 관점으로 생각하기

### 5가지 핵심 개념

- 공유된 가변 자료구조를 줄이는 것은 장기적으로 프로그램을 유지보수하고 디버깅하는데 도움이 된다
    - 공유된 가변 자료구조:

       ![13-1](https://user-images.githubusercontent.com/64471645/113513106-f2761e80-95a2-11eb-902d-d80c04174ba6.JPG)

        리스트를 참조하는 여러 클래스가 있다고 가정하면 리스트는 공유된 가변 자료구조이다.

        위험한 이유? 변수가 예상치 않은 값을 가질 수 있음.

        공유된 가변 데이터 대신 명확하고 예상 가능한 데이터를 활용하면 프로그램의 유지보수가 쉬워질 것이다.

- 함수형 프로그래밍은 부작용이 없는 메서드와 선언형 프로그래밍 방식을 지향한다.
    - 함수형 프로그래밍

        선언형 프로그래밍을 따르는 대표적인 방식으로 함수를 이용하는 프로그래밍이다.

        - 선언형 프로그래밍

            '어떻게'가 아닌 '무엇을'에 집중하는 방식. 

            - 어떻게 ex) 할당, 조건문, 분기문, 루프 등
            - 무엇을 ex) 내부반복, 스트림 등
        - 함수란?

            0개 이상의 인수를 가지며, 한 개 이상의 결과를 반환하지만 부작용이 없어야 한다.

            내부적으로는 부작용이 발생하지만 호출자가 이를 알아차리지 못한다면 괜찮다. 

    - 부작용
        - 자료구조를 고치거나 필드에 값을 할당(setter 메서드 같은 생성자 이외의 초기화 동작)
        - 예외 발생
        - 파일에 쓰기 등의 I/O 동작 수행
- 함수형 메서드는 입력 인수와 출력 결과만을 갖는다.
    - 예

        ```java
        public void searchForGold(List<String> l, Stats stats) {
        	for(String s: l) {
        		if("gold".equals(s)) {
        			stats.incrementFor("gold");
        		}
        	}
        }
        ```

        ```java
        class Stats {
        	private int goldNum;

        	public void incrementFor(String s) {
        		if(s.equals("gold")) goldNum++;
        	}	
        }
        ```

        단일 스레드로 실행되는 프로그램의 입장에서는 이 메서드가 아무 부작용을 일으키지 않으므로 이 메서드는 함수형이라 간주할 수 있다. 

        But, 다른 스레드가 필드의 값을 확인한다든가 아니면 동시에 이 메서드를 호출하는 상황이 발생할 수 있다면 이 메서드는 함수형이 아니다.

        CQRS 변경과 조회의 분리!

- 같은 인수값으로 함수를 호출했을 때 항상 같은 값을 반환하며 참조 투명성을 갖는 함수다. while 루프 같은 반복문은 재귀로 대체할 수 있다.
    - 참조 투명성

        같은 인수로 함수를 호출했을 때 항상 같은 결과를 반환한다.

    - 예 - 참조 투명성을 가지지 않는다.

        ```java
        Random.nextInt(10);

        Scanner.nextLine();
        ```

- 자바에서는 고전 방식의 재귀보다는 꼬리 재귀를 사용해야 추가적인 컴파일러 최적화를 기대할 수 있다.
    - 꼬리 재귀

       ![꼬리 재귀](https://user-images.githubusercontent.com/64471645/113513128-09b50c00-95a3-11eb-95da-6752face1eaa.JPG)
